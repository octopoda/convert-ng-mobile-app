// Eatr Application build AngularJS
// Zack Davis
// Octopoda Interactive;
var convert=angular.module("convert",[]);convert.config(function(e){e.when("/calculator",{templateUrl:"/views/layouts/calculator.html",controller:"calculatorController"}).when("/recipe",{templateUrl:"/views/layouts/recipe.html",controller:"recipeController"}).otherwise({redirectTo:"/calculator"})});convert.factory("FlashService",function(e){return{show:function(t){e.flash=t;$(".flash").append('<i class="pull-right close icon-cancel-circled" ng-click="clearFlash()"></i>')},clear:function(){e.flash="";$(".flash").children(".close").remove()}}});convert.factory("ItemService",function(e){return{itemArray:[],setItems:function(e){this.itemArray.push(e);this.broadcast()},clearItems:function(){this.itemArray=[];this.broadcast()},broadcast:function(){e.$broadcast("itemBroadCast")}}});convert.factory("CostService",function(e){return{finalCost:0,setCost:function(e){this.finalCost+=e;this.broadcast()},clearCost:function(){this.finalCost=0;this.broadcast()},broadcast:function(){e.$broadcast("costBroadcast")}}});convert.factory("DataService",function(e){return{get:function(){var e=[{name:"tsp",toMetric:5,type:"Dry Volume",unit:"ml"},{name:"tbsp",toMetic:15,type:"Dry Volume",unit:"ml"},{name:"cup",toMetric:225,type:"Dry Volume",unit:"ml"},{name:"pint",toMetric:450,type:"Dry Volume",unit:"ml"},{name:"quart",toMetric:1e3,type:"Dry Volume",unit:"ml"},{name:"gallon",toMetric:4e3,type:"Dry Volume",unit:"ml"},{name:"oz",toMetric:28.3,type:"Dry Weight",unit:"g"},{name:"tbsp",toMetric:14.3,type:"Dry Weight",unit:"g"},{name:"cup",toMetric:226.4,type:"Dry Weight",unit:"g"},{name:"pound",toMetric:452.8,type:"Dry Weight",unit:"g"},{name:"fl oz",toMetric:30,type:"Liquid Volume",unit:"ml"},{name:"cup",toMetric:250,type:"Liquid Volume",unit:"ml"},{name:"pint",toMetric:500,type:"Liquid Volume",unit:"ml"},{name:"quart",toMetric:1e3,type:"Liquid Volume",unit:"ml"},{name:"gallon",toMetric:4e3,type:"Liquid Volume",unit:"ml"}];return e}}});convert.factory("NavigationSerivce",function(e){return{view:"calculate",icon:"right",setNavigation:function(e){if(e=="calculate"){this.view="calculate";this.icon="right"}else{this.view="recipe";this.icon="left"}this.setIcon();this.broadcast()},setIcon:function(){if(this.icon=="right"){$(".right").addClass("active");$(".left").removeClass("active")}else{$(".left").addClass("active");$(".right").removeClass("active")}},broadcast:function(){e.$broadcast("navigationBroadcast")}}});convert.controller("application",function(e,t,n,r,i,s){e.toggleView=function(e,t){s.setNavigation(e)};e.clearFlash=function(){n.clear()};e.$on("navigationBroadcast",function(){e.view=s.view;$("."+s.icon).addClass("active")})});convert.controller("calculatorController",function(e,t,n,r,i,s){_data=r.get();e.convertData=_data;e.grocery=null;e.food=null;e.recipeCost=s.finalCost;e.convert=function(){if(this.grocery.unit.type!=this.food.unit.type){n.show("Shit! Your units don't match");return!1}$one=this.convertDown(this.grocery.unit.toMetric,this.grocery.amount);$two=this.convertDown(this.food.unit.toMetric,this.food.amount);$cost=this.compare($one,$two,this.grocery.cost);$cost<.009&&n.show("Yo that's less than a penny!");i.setItems($cost);s.setCost($cost);this.grocery=null;this.food=null};e.convertDown=function(e,t){return e*t};e.compare=function(e,t,n){return n*t/e};e.$on("costBroadcast",function(t){e.recipeCost=s.finalCost})});convert.controller("recipeController",function(e,t,n,r,i){e.recipeCost=i.finalCost;e.itemsCost=r.itemArray;e.clear=function(){i.clearCost();r.clearItems()};e.$on("costBroadcast",function(t){e.recipeCost=i.finalCost});e.$on("itemBroadCast",function(t){e.itemsCost=r.itemArray})});